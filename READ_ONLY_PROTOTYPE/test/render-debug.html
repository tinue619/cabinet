<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üõë –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –†–ï–ù–î–ï–†–ò–ù–ì–ê</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1a1a1a;
            color: #00ff00;
        }
        
        .console {
            background: #000;
            padding: 20px;
            border-radius: 8px;
            font-size: 14px;
            white-space: pre-wrap;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .error { color: #ff4444; }
        .success { color: #44ff44; }
        .warning { color: #ffff44; }
        .info { color: #4444ff; }
        
        button {
            padding: 10px 20px;
            margin: 5px;
            background: #333;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        button:hover {
            background: #555;
        }
    </style>
</head>
<body>
    <h1>üõë –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ü–†–û–ë–õ–ï–ú–´ –†–ï–ù–î–ï–†–ò–ù–ì–ê</h1>
    
    <div>
        <button onclick="checkCabinetProperties()">1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤–æ–π—Å—Ç–≤–∞ Cabinet</button>
        <button onclick="checkAppObject()">2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—ä–µ–∫—Ç app</button>
        <button onclick="checkTransform()">3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å transform</button>
        <button onclick="checkCanvas()">4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å canvas</button>
        <button onclick="createTestCabinet()">5. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —à–∫–∞—Ñ</button>
        <button onclick="compareWithOriginal()">6. –°—Ä–∞–≤–Ω–∏—Ç—å —Å –æ—Ä–∏–≥–∏–Ω–∞–ª–æ–º</button>
    </div>
    
    <div id="console" class="console"></div>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º —Ç–µ –∂–µ —Å–∫—Ä–∏–ø—Ç—ã -->
    <script src="../js/config.js"></script>
    <script src="../js/cabinet.js"></script>

    <script>
        let testCabinet = null;
        
        function log(message, type = 'info') {
            const console = document.getElementById('console');
            const span = document.createElement('div');
            span.className = type;
            span.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            console.appendChild(span);
            console.scrollTop = console.scrollHeight;
        }

        function checkCabinetProperties() {
            log('=== –ü–†–û–í–ï–†–ö–ê –°–í–û–ô–°–¢–í –ö–õ–ê–°–°–ê CABINET ===', 'warning');
            
            try {
                const cabinet = new Cabinet(800, 1800, 500, 100);
                
                log(`cabinet.width: ${cabinet.width} (${typeof cabinet.width})`, 'info');
                log(`cabinet.height: ${cabinet.height} (${typeof cabinet.height})`, 'info');
                log(`cabinet.depth: ${cabinet.depth} (${typeof cabinet.depth})`, 'info');
                log(`cabinet.base: ${cabinet.base} (${typeof cabinet.base})`, 'info');
                
                log(`cabinet.interiorWidth: ${cabinet.interiorWidth}`, 'info');
                log(`cabinet.interiorHeight: ${cabinet.interiorHeight}`, 'info');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞—Ç–µ—Ä–ª–∏—Å—å –ª–∏ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞
                if (cabinet.width === 800 && cabinet.height === 1800) {
                    log('‚úÖ –ë–∞–∑–æ–≤—ã–µ —Ä–∞–∑–º–µ—Ä—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã', 'success');
                } else {
                    log('‚ùå –ë–∞–∑–æ–≤—ã–µ —Ä–∞–∑–º–µ—Ä—ã –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã!', 'error');
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–µ—Ç–æ–¥—ã
                log(`–ú–µ—Ç–æ–¥—ã: getAllParts=${typeof cabinet.getAllParts}, getTotalVolume=${typeof cabinet.getTotalVolume}`, 'info');
                
                testCabinet = cabinet;
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —à–∫–∞—Ñ–∞: ${error.message}`, 'error');
            }
        }

        function checkAppObject() {
            log('=== –ü–†–û–í–ï–†–ö–ê –û–ë–™–ï–ö–¢–ê APP ===', 'warning');
            
            // –≠–º—É–ª–∏—Ä—É–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É app
            const fakeApp = {
                cabinet: testCabinet,
                canvas: null,
                ctx: null,
                scale: 1
            };
            
            if (fakeApp.cabinet) {
                log(`app.cabinet.width: ${fakeApp.cabinet.width}`, 'info');
                log(`app.cabinet.height: ${fakeApp.cabinet.height}`, 'info');
                log(`app.scale: ${fakeApp.scale}`, 'info');
                
                if (fakeApp.cabinet.width > 0 && fakeApp.cabinet.height > 0) {
                    log('‚úÖ –û–±—ä–µ–∫—Ç app.cabinet –≤—ã–≥–ª—è–¥–∏—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ', 'success');
                } else {
                    log('‚ùå –ü—Ä–æ–±–ª–µ–º–∞ —Å –æ–±—ä–µ–∫—Ç–æ–º app.cabinet!', 'error');
                }
            } else {
                log('‚ùå app.cabinet –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç!', 'error');
            }
        }

        function checkTransform() {
            log('=== –ü–†–û–í–ï–†–ö–ê –§–£–ù–ö–¶–ò–ò TRANSFORM ===', 'warning');
            
            if (!testCabinet) {
                log('‚ùå –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —à–∫–∞—Ñ!', 'error');
                return;
            }
            
            // –≠–º—É–ª–∏—Ä—É–µ–º calculateTransform
            const mockCanvasRect = { width: 800, height: 600 };
            const PADDING = 60;
            const scale = 1;
            
            const availableW = mockCanvasRect.width - 2 * PADDING;
            const availableH = mockCanvasRect.height - 2 * PADDING;
            
            log(`availableW: ${availableW}`, 'info');
            log(`availableH: ${availableH}`, 'info');
            log(`cabinet.width: ${testCabinet.width}`, 'info');
            log(`cabinet.height: ${testCabinet.height}`, 'info');
            
            const scaleX = availableW / testCabinet.width;
            const scaleY = availableH / testCabinet.height;
            const finalScale = Math.min(scaleX, scaleY) * scale;
            
            log(`scaleX: ${scaleX}`, 'info');
            log(`scaleY: ${scaleY}`, 'info');
            log(`finalScale: ${finalScale}`, 'info');
            
            const cabinetW = testCabinet.width * finalScale;
            const cabinetH = testCabinet.height * finalScale;
            
            log(`cabinetW: ${cabinetW}`, 'info');
            log(`cabinetH: ${cabinetH}`, 'info');
            
            if (finalScale > 0 && cabinetW > 10 && cabinetH > 10) {
                log('‚úÖ Transform –≤—ã–≥–ª—è–¥–∏—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ', 'success');
            } else {
                log('‚ùå –ü—Ä–æ–±–ª–µ–º–∞ —Å transform!', 'error');
                log(`–í–æ–∑–º–æ–∂–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞: finalScale=${finalScale}, cabinetW=${cabinetW}, cabinetH=${cabinetH}`, 'error');
            }
        }

        function checkCanvas() {
            log('=== –ü–†–û–í–ï–†–ö–ê CANVAS ===', 'warning');
            
            // –í –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–æ–º —Ä–µ–∂–∏–º–µ canvas –º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å
            log('Canvas –≤ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–æ–º —Ä–µ–∂–∏–º–µ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è', 'info');
            log('–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ:', 'info');
            log('1. document.getElementById("canvas") !== null', 'info');
            log('2. canvas.getBoundingClientRect().width > 0', 'info');
            log('3. canvas.getBoundingClientRect().height > 0', 'info');
        }

        function createTestCabinet() {
            log('=== –°–û–ó–î–ê–ù–ò–ï –¢–ï–°–¢–û–í–û–ì–û –®–ö–ê–§–ê ===', 'warning');
            
            const sizes = [
                [800, 1800, 500, 100],
                [1000, 2000, 600, 120],
                [600, 1600, 400, 80]
            ];
            
            sizes.forEach((size, index) => {
                try {
                    const cabinet = new Cabinet(...size);
                    log(`–¢–µ—Å—Ç ${index + 1}: ${size.join('√ó')} = ${cabinet.width}√ó${cabinet.height}√ó${cabinet.depth}√ó${cabinet.base}`, 'success');
                } catch (error) {
                    log(`–¢–µ—Å—Ç ${index + 1}: –û—à–∏–±–∫–∞ - ${error.message}`, 'error');
                }
            });
        }

        function compareWithOriginal() {
            log('=== –°–†–ê–í–ù–ï–ù–ò–ï –° –û–†–ò–ì–ò–ù–ê–õ–¨–ù–û–ô –°–¢–†–£–ö–¢–£–†–û–ô ===', 'warning');
            
            if (!testCabinet) {
                log('‚ùå –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —à–∫–∞—Ñ!', 'error');
                return;
            }
            
            const expectedProperties = [
                'width', 'height', 'depth', 'base', 
                'dividers', 'rods', 'sections'
            ];
            
            expectedProperties.forEach(prop => {
                if (testCabinet.hasOwnProperty(prop)) {
                    log(`‚úÖ ${prop}: ${typeof testCabinet[prop]} = ${JSON.stringify(testCabinet[prop]).substring(0, 50)}...`, 'success');
                } else {
                    log(`‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Å–≤–æ–π—Å—Ç–≤–æ: ${prop}`, 'error');
                }
            });
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã
            const newMethods = ['getAllParts', 'getTotalVolume', 'getTotalCost', 'addDivider'];
            newMethods.forEach(method => {
                if (typeof testCabinet[method] === 'function') {
                    log(`‚úÖ –ú–µ—Ç–æ–¥ ${method}: –Ω–∞–π–¥–µ–Ω`, 'success');
                } else {
                    log(`‚ùå –ú–µ—Ç–æ–¥ ${method}: –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç`, 'error');
                }
            });
        }

        // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
        window.onload = function() {
            log('üõë –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ü–†–û–ë–õ–ï–ú–´ –†–ï–ù–î–ï–†–ò–ù–ì–ê –ù–ê–ß–ê–¢–ê', 'warning');
            log('–ù–∞–∂–∏–º–∞–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –ø–æ –ø–æ—Ä—è–¥–∫—É –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã', 'info');
            setTimeout(checkCabinetProperties, 500);
        };
    </script>
</body>
</html>