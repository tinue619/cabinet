# 🔧 ПЛАН ИНТЕГРАЦИИ ФУНКЦИОНАЛА v2.0 → v3.1

**Дата:** 2025-01-13  
**Цель:** Перенести работающий функционал из версии 2.0 на новое ядро v3.1

## 🎯 СТРАТЕГИЯ ИНТЕГРАЦИИ

### ✅ НЕ ТРОГАЕМ ЯДРО!
- Ядро v3.1 остается неизменным
- Все новое - в виде модулей и систем
- Используем события и фабрики ядра

### 🏗️ СОЗДАЕМ НОВЫЕ МОДУЛИ:

## 📋 ЭТАП 1: СИСТЕМЫ УПРАВЛЕНИЯ

### 1.1 История операций
```
systems/
├── HistoryManager.js      # Undo/Redo на основе v2.0
```

### 1.2 Рендеринг и визуализация  
```
systems/
├── Renderer2D.js          # Canvas отрисовка из v2.0
├── Renderer3D.js          # Three.js рендер из v2.0
├── ViewManager.js         # Переключение 2D/3D
```

### 1.3 UI и события
```
systems/
├── UIManager.js           # Управление интерфейсом
├── EventHandler.js        # Обработка событий из v2.0
├── MobileManager.js       # Мобильная оптимизация
```

## 📋 ЭТАП 2: ФИЧИ (ENTITIES/FEATURES)

### 2.1 Разделители
```
entities/features/dividers/
├── Divider.js             # Полки и стойки на новом ядре
├── DividerManager.js      # Управление разделителями
```

### 2.2 Штанги
```
entities/features/rods/
├── Rod.js                 # Штанги на новом ядре  
├── RodManager.js          # Управление штангами
```

## 📋 ЭТАП 3: ИНТЕРФЕЙС

### 3.1 Web-интерфейс
```
web/
├── index.html             # Основной интерфейс из v2.0
├── css/                   # Стили из v2.0
├── app.js                 # Главный файл приложения
```

## 🔧 ПРИНЦИПЫ ИНТЕГРАЦИИ

### ✅ Правильно:
```javascript
// Используем ядро через события и фабрики
import { SystemFactory } from '../index.js';

class HistoryManager {
  constructor(system) {
    this.system = system;
    // Подписываемся на события ядра
    system.events.on('cabinet-generated', this.onCabinetChange);
  }
}
```

### ❌ Неправильно:
```javascript
// НЕ вмешиваемся в ядро!
import { Cabinet } from '../entities/Cabinet.js';
Cabinet.prototype.newMethod = () => { ... } // ❌ НЕТ!
```

## 🎯 АЛГОРИТМ ПЕРЕНОСА

### Для каждого компонента v2.0:

1. **Анализируем логику** - что делает компонент
2. **Выделяем данные** - что хранит компонент  
3. **Создаем обертку** - как подключить к ядру v3.1
4. **Используем события** - как интегрировать реактивно
5. **Тестируем** - проверяем работоспособность

## 📦 СТРУКТУРА ПОСЛЕ ИНТЕГРАЦИИ

```
архитектурная_зигота/
├── core/                  # ✅ ЯДРО (не трогаем)
├── entities/              # ✅ СУЩНОСТИ (не трогаем) 
├── systems/               # 🆕 НОВЫЕ СИСТЕМЫ
│   ├── HistoryManager.js
│   ├── Renderer2D.js
│   ├── Renderer3D.js
│   ├── ViewManager.js
│   ├── UIManager.js
│   └── MobileManager.js
├── web/                   # 🆕 WEB-ИНТЕРФЕЙС
│   ├── index.html
│   ├── css/
│   └── js/
└── examples/              # 🆕 ПРИМЕРЫ И ДЕМО
```

## 🚀 ПОРЯДОК РЕАЛИЗАЦИИ

### Неделя 1: Базовые системы
- [ ] HistoryManager
- [ ] Renderer2D  
- [ ] EventHandler

### Неделя 2: Фичи
- [ ] Dividers (разделители)
- [ ] Rods (штанги)

### Неделя 3: UI и мобилка
- [ ] UIManager
- [ ] MobileManager
- [ ] ViewManager

### Неделя 4: Интеграция
- [ ] Web-интерфейс
- [ ] Тестирование
- [ ] Документация

---

**Результат:** Получаем всю функциональность v2.0 на надежном ядре v3.1!
