<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß™ –¢–µ—Å—Ç –ø–µ—Ä–µ–¥–Ω–µ–≥–æ —Ü–æ–∫–æ–ª—è</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .result {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 10px;
            margin: 10px 0;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .success { border-color: #28a745; background: #d4edda; }
        .error { border-color: #dc3545; background: #f8d7da; }
        .warning { border-color: #ffc107; background: #fff3cd; }
        
        canvas {
            border: 1px solid #ccc;
            background: white;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç –ø–µ—Ä–µ–¥–Ω–µ–≥–æ —Ü–æ–∫–æ–ª—è</h1>
    
    <div class="test-container">
        <h2>üìã –ü–ª–∞–Ω —Ç–µ—Å—Ç–∞:</h2>
        <ul>
            <li>1. –ó–∞–≥—Ä—É–∑–∏—Ç—å —è–¥—Ä–æ Cabinet</li>
            <li>2. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —à–∫–∞—Ñ</li>
            <li>3. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–∞–Ω–µ–ª–∏</li>
            <li>4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–µ—Ä–µ–¥–Ω–µ–≥–æ —Ü–æ–∫–æ–ª—è</li>
            <li>5. –û—Ç—Ä–∏—Å–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç</li>
        </ul>
    </div>

    <div class="test-container">
        <h2>üî¨ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</h2>
        <div id="results"></div>
    </div>

    <div class="test-container">
        <h2>üé® –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (2D –≤–∏–¥ —Å–≤–µ—Ä—Ö—É):</h2>
        <canvas id="canvas" width="600" height="400"></canvas>
    </div>

    <script type="module">
        // üèóÔ∏è UI LAYER - –¢–µ—Å—Ç –ø–µ—Ä–µ–¥–Ω–µ–≥–æ —Ü–æ–∫–æ–ª—è
        // –¢–û–õ–¨–ö–û –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –ë–ï–ó –ª–æ–≥–∏–∫–∏

        let results = document.getElementById('results');
        let canvas = document.getElementById('canvas');
        let ctx = canvas.getContext('2d');

        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `result ${type}`;
            div.textContent = message;
            results.appendChild(div);
            console.log(message);
        }

        async function runTest() {
            try {
                log('üöÄ –ù–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç –ø–µ—Ä–µ–¥–Ω–µ–≥–æ —Ü–æ–∫–æ–ª—è...', 'info');

                // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —è–¥—Ä–æ
                log('üì¶ –ó–∞–≥—Ä—É–∂–∞–µ–º Cabinet –∏ CABINET_DNA...', 'info');
                
                const { Cabinet } = await import('./new_core/entities/Cabinet.js');
                const { CABINET_DNA } = await import('./new_core/cabinet-dna.js');
                
                log('‚úÖ –Ø–¥—Ä–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ', 'success');

                // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —à–∫–∞—Ñ
                log('üèóÔ∏è –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —à–∫–∞—Ñ 800√ó2000√ó600...', 'info');
                
                const cabinet = new Cabinet({
                    width: 800,
                    height: 2000,
                    depth: 600,
                    baseHeight: 100
                });

                log(`‚úÖ –®–∫–∞—Ñ —Å–æ–∑–¥–∞–Ω: ${cabinet.dimensions.width}√ó${cabinet.dimensions.height}√ó${cabinet.dimensions.depth}`, 'success');
                log(`üìè –í—ã—Å–æ—Ç–∞ —Ü–æ–∫–æ–ª—è: ${cabinet.dimensions.baseHeight}–º–º`, 'info');

                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–∞–Ω–µ–ª–∏
                log('‚öôÔ∏è –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–∞–Ω–µ–ª–∏...', 'info');
                cabinet.generate();
                
                const stats = cabinet.getStats();
                log(`‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞: ${stats.panelsCount} –ø–∞–Ω–µ–ª–µ–π, ${stats.sectionsCount} —Å–µ–∫—Ü–∏–π`, 'success');

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ–¥–Ω–∏–π —Ü–æ–∫–æ–ª—å
                log('üîç –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–µ—Ä–µ–¥–Ω–∏–π —Ü–æ–∫–æ–ª—å...', 'info');
                
                const frontBase = cabinet.getPanel('FRONT_BASE');
                if (!frontBase) {
                    log('‚ùå –ü–µ—Ä–µ–¥–Ω–∏–π —Ü–æ–∫–æ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
                    return;
                }

                log(`‚úÖ –ü–µ—Ä–µ–¥–Ω–∏–π —Ü–æ–∫–æ–ª—å –Ω–∞–π–¥–µ–Ω: ${frontBase.name}`, 'success');

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —Ñ–æ—Ä–º—É–ª—ã
                log('üìê –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º—É–ª—ã –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ä–∞–∑–º–µ—Ä–æ–≤...', 'info');
                
                const dims = cabinet.dimensions;
                const t = cabinet.materialThickness;
                const b = dims.baseHeight;
                
                log(`üìä –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: x=${dims.width}, y=${dims.height}, z=${dims.depth}, t=${t}, b=${b}`, 'info');
                
                // –û–∂–∏–¥–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ –Ω–æ–≤—ã–º —Ñ–æ—Ä–º—É–ª–∞–º
                const expectedPosition = CABINET_DNA.GENERATION.POSITION_FORMULAS.FRONT_BASE(
                    dims.width, dims.height, dims.depth, t, b
                );
                
                const expectedSize = CABINET_DNA.GENERATION.SIZE_FORMULAS.FRONT_BASE(
                    dims.width, dims.height, dims.depth, t, b
                );
                
                const actualPosition = frontBase.position;
                const actualSize = frontBase.dimensions;
                
                log(`üìç –ü–û–ó–ò–¶–ò–Ø:`, 'info');
                log(`  –û–∂–∏–¥–∞–µ–º–∞—è: x=${expectedPosition.x}, y=${expectedPosition.y}, z=${expectedPosition.z}`, 'info');
                log(`  –§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è: x=${actualPosition.x}, y=${actualPosition.y}, z=${actualPosition.z}`, 'info');
                
                log(`üìè –†–ê–ó–ú–ï–†–´:`, 'info');
                log(`  –û–∂–∏–¥–∞–µ–º—ã–µ: width=${expectedSize.width}, height=${expectedSize.height}, depth=${expectedSize.depth}`, 'info');
                log(`  –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ: width=${actualSize.width}, height=${actualSize.height}, depth=${actualSize.depth}`, 'info');

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ü–æ–∫–æ–ª—å –≤–Ω–∏–∑—É
                const isAtBottom = expectedPosition.y === (dims.height - b);
                if (isAtBottom) {
                    log('‚úÖ –ü–û–ó–ò–¶–ò–Ø: –¶–æ–∫–æ–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –í–ù–ò–ó–£!', 'success');
                } else {
                    log(`‚ùå –ü–û–ó–ò–¶–ò–Ø: –¶–æ–∫–æ–ª—å —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ! –û–∂–∏–¥–∞–ª–æ—Å—å y=${dims.height - b}`, 'error');
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä—ã
                const correctWidth = expectedSize.width === (dims.width - 2*t);
                const correctHeight = expectedSize.height === b;
                const correctDepth = expectedSize.depth === t;
                
                if (correctWidth && correctHeight && correctDepth) {
                    log('‚úÖ –†–ê–ó–ú–ï–†–´: –í—Å–µ —Ä–∞–∑–º–µ—Ä—ã –ø–µ—Ä–µ–¥–Ω–µ–≥–æ —Ü–æ–∫–æ–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã!', 'success');
                } else {
                    log('‚ùå –†–ê–ó–ú–ï–†–´: –ù–∞–π–¥–µ–Ω—ã –æ—à–∏–±–∫–∏ –≤ —Ä–∞–∑–º–µ—Ä–∞—Ö:', 'error');
                    if (!correctWidth) log(`  –ù–µ–≤–µ—Ä–Ω–∞—è —à–∏—Ä–∏–Ω–∞: –æ–∂–∏–¥–∞–ª–æ—Å—å ${dims.width - 2*t}, –ø–æ–ª—É—á–µ–Ω–æ ${expectedSize.width}`, 'error');
                    if (!correctHeight) log(`  –ù–µ–≤–µ—Ä–Ω–∞—è –≤—ã—Å–æ—Ç–∞: –æ–∂–∏–¥–∞–ª–æ—Å—å ${b}, –ø–æ–ª—É—á–µ–Ω–æ ${expectedSize.height}`, 'error');
                    if (!correctDepth) log(`  –ù–µ–≤–µ—Ä–Ω–∞—è –≥–ª—É–±–∏–Ω–∞: –æ–∂–∏–¥–∞–ª–æ—Å—å ${t}, –ø–æ–ª—É—á–µ–Ω–æ ${expectedSize.depth}`, 'error');
                }

                // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –ø–∞–Ω–µ–ª–∏ –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏
                const panels = cabinet.getPanels();
                log(`üé® –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º ${panels.length} –ø–∞–Ω–µ–ª–µ–π –≤ 2D...`, 'info');

                // –†–∏—Å—É–µ–º 2D –≤–∏–¥ —Å–≤–µ—Ä—Ö—É
                drawCabinet(panels, cabinet.dimensions);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤—Å–µ—Ö –ø–∞–Ω–µ–ª–µ–π
                log('üìã –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤—Å–µ—Ö –ø–∞–Ω–µ–ª–µ–π:', 'info');
                panels.forEach(panel => {
                    const pos = panel.position;
                    const size = panel.dimensions;
                    log(`  ${panel.key}: pos(${pos.x}, ${pos.y}, ${pos.z}) size(${size.width}√ó${size.height}√ó${size.depth})`, 'info');
                });
                
                log('üéâ –¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!', 'success');

            } catch (error) {
                log(`üí• –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∞: ${error.message}`, 'error');
                console.error('Test error:', error);
            }
        }

        function drawCabinet(panels, dimensions) {
            // –û—á–∏—â–∞–µ–º canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // –ú–∞—Å—à—Ç–∞–± –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
            const scale = Math.min(
                (canvas.width - 150) / dimensions.width,
                (canvas.height - 150) / dimensions.height
            );
            
            const offsetX = (canvas.width - dimensions.width * scale) / 2;
            const offsetY = (canvas.height - dimensions.height * scale) / 2;

            // –¶–≤–µ—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø–∞–Ω–µ–ª–µ–π
            const colors = {
                'FRONT_BASE': '#ff4757',    // –Ø—Ä–∫–æ-–∫—Ä–∞—Å–Ω—ã–π –¥–ª—è –ø–µ—Ä–µ–¥–Ω–µ–≥–æ —Ü–æ–∫–æ–ª—è
                'BACK_BASE': '#2ed573',     // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –∑–∞–¥–Ω–µ–≥–æ —Ü–æ–∫–æ–ª—è
                'LEFT_SIDE': '#3742fa',     // –°–∏–Ω–∏–π –¥–ª—è –±–æ–∫–æ–≤–∏–Ω
                'RIGHT_SIDE': '#3742fa',
                'TOP': '#ffa502',           // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –≤–µ—Ä—Ö–∞
                'BOTTOM': '#ff6348',        // –ö—Ä–∞—Å–Ω–æ-–æ—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –Ω–∏–∑–∞
                'BACK_WALL': '#f1c40f',     // –ñ–µ–ª—Ç—ã–π –¥–ª—è –∑–∞–¥–Ω–µ–π —Å—Ç–µ–Ω–∫–∏
                'FACADE': '#9c88ff'         // –§–∏–æ–ª–µ—Ç–æ–≤—ã–π –¥–ª—è —Ñ–∞—Å–∞–¥–∞
            };

            // –†–∏—Å—É–µ–º –æ–±—â–∏–π –∫–æ–Ω—Ç—É—Ä —à–∫–∞—Ñ–∞
            ctx.strokeStyle = '#2c3e50';
            ctx.lineWidth = 3;
            ctx.strokeRect(offsetX, offsetY, dimensions.width * scale, dimensions.height * scale);

            // –†–∏—Å—É–µ–º –ø–∞–Ω–µ–ª–∏
            panels.forEach(panel => {
                const pos = panel.position;
                const size = panel.dimensions;
                
                // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–∞ canvas (2D –≤–∏–¥ —Å–≤–µ—Ä—Ö—É, –∏—Å–ø–æ–ª—å–∑—É–µ–º X –∏ Y)
                const x = offsetX + pos.x * scale;
                const y = offsetY + pos.y * scale;
                const w = size.width * scale;
                const h = size.height * scale;

                // –ó–∞–ª–∏–≤–∫–∞
                ctx.fillStyle = colors[panel.key] || '#ecf0f1';
                ctx.fillRect(x, y, w, h);

                // –û–±–≤–æ–¥–∫–∞
                ctx.strokeStyle = '#2c3e50';
                ctx.lineWidth = 1;
                ctx.strokeRect(x, y, w, h);

                // –ü–æ–¥–ø–∏—Å—å
                ctx.fillStyle = '#2c3e50';
                ctx.font = '11px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                
                const text = panel.key === 'FRONT_BASE' ? '–¶–û–ö–û–õ–¨ –ü–ï–†–ï–î–ù–ò–ô' : 
                           panel.key === 'BACK_BASE' ? '–¶–û–ö–û–õ–¨ –ó–ê–î–ù–ò–ô' :
                           panel.name;
                           
                // –†–∏—Å—É–µ–º —Ç–µ–∫—Å—Ç —Å –æ–±–≤–æ–¥–∫–æ–π –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
                ctx.strokeStyle = '#ffffff';
                ctx.lineWidth = 3;
                ctx.strokeText(text, x + w/2, y + h/2);
                ctx.fillText(text, x + w/2, y + h/2);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –¥–ª—è –ø–µ—Ä–µ–¥–Ω–µ–≥–æ —Ü–æ–∫–æ–ª—è
                if (panel.key === 'FRONT_BASE') {
                    ctx.fillStyle = '#ff4757';
                    ctx.font = '10px Arial';
                    ctx.fillText(`${size.width}√ó${size.height}√ó${size.depth}`, x + w/2, y + h/2 + 15);
                }
            });

            // –†–∏—Å—É–µ–º —Ä–∞–∑–º–µ—Ä—ã —à–∫–∞—Ñ–∞
            ctx.strokeStyle = '#7f8c8d';
            ctx.font = '14px Arial';
            ctx.fillStyle = '#2c3e50';
            
            // –®–∏—Ä–∏–Ω–∞
            const topY = offsetY - 30;
            ctx.fillText(`${dimensions.width}–º–º`, offsetX + (dimensions.width * scale) / 2, topY);
            
            // –í—ã—Å–æ—Ç–∞
            const leftX = offsetX - 50;
            ctx.save();
            ctx.translate(leftX, offsetY + (dimensions.height * scale) / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText(`${dimensions.height}–º–º`, 0, 0);
            ctx.restore();
            
            // –í—ã—Å–æ—Ç–∞ —Ü–æ–∫–æ–ª—è
            ctx.fillStyle = '#ff4757';
            ctx.font = '12px Arial';
            ctx.fillText(`–¶–æ–∫–æ–ª—å: ${dimensions.baseHeight}–º–º`, offsetX + 10, offsetY + dimensions.height * scale - 10);
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç
        runTest();

    </script>
</body>
</html>
                    height: 2000,
                    depth: 600,
                    baseHeight: 100
                });

                log(`‚úÖ –®–∫–∞—Ñ —Å–æ–∑–¥–∞–Ω: ${cabinet.dimensions.width}√ó${cabinet.dimensions.height}√ó${cabinet.dimensions.depth}`, 'success');

                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–∞–Ω–µ–ª–∏
                log('‚öôÔ∏è –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–∞–Ω–µ–ª–∏...', 'info');
                cabinet.generate();
                
                const stats = cabinet.getStats();
                log(`‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞: ${stats.panelsCount} –ø–∞–Ω–µ–ª–µ–π, ${stats.sectionsCount} —Å–µ–∫—Ü–∏–π`, 'success');

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ–¥–Ω–∏–π —Ü–æ–∫–æ–ª—å
                log('üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ–¥–Ω–∏–π —Ü–æ–∫–æ–ª—å...', 'info');
                
                const frontBase = cabinet.getPanel('FRONT_BASE');
                if (!frontBase) {
                    log('‚ùå –ü–µ—Ä–µ–¥–Ω–∏–π —Ü–æ–∫–æ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
                    return;
                }

                log(`‚úÖ –ü–µ—Ä–µ–¥–Ω–∏–π —Ü–æ–∫–æ–ª—å –Ω–∞–π–¥–µ–Ω: ${frontBase.name}`, 'success');

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º—É–ª—É –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
                log('üìê –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º—É–ª—É –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è...', 'info');
                
                const dims = cabinet.dimensions;
                const t = cabinet.materialThickness;
                const b = dims.baseHeight;
                
                const expectedPosition = CABINET_DNA.GENERATION.POSITION_FORMULAS.FRONT_BASE(
                    dims.width, dims.height, dims.depth, t, b
                );
                
                const actualPosition = frontBase.position;
                
                log(`üìä –û–∂–∏–¥–∞–µ–º–∞—è –ø–æ–∑–∏—Ü–∏—è: x=${expectedPosition.x}, y=${expectedPosition.y}, z=${expectedPosition.z}`, 'info');
                log(`üìä –§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–∑–∏—Ü–∏—è: x=${actualPosition.x}, y=${actualPosition.y}, z=${actualPosition.z}`, 'info');

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ü–æ–∫–æ–ª—å –≤–Ω–∏–∑—É
                if (expectedPosition.y === dims.height - b) {
                    log('‚úÖ –¶–æ–∫–æ–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –í–ù–ò–ó–£!', 'success');
                } else {
                    log(`‚ùå –¶–æ–∫–æ–ª—å —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ! –û–∂–∏–¥–∞–ª–æ—Å—å y=${dims.height - b}`, 'error');
                }

                // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –ø–∞–Ω–µ–ª–∏ –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏
                const panels = cabinet.getPanels();
                log(`üé® –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º ${panels.length} –ø–∞–Ω–µ–ª–µ–π...`, 'info');

                // –†–∏—Å—É–µ–º 2D –≤–∏–¥ —Å–≤–µ—Ä—Ö—É
                drawCabinet(panels, cabinet.dimensions);
                
                log('üéâ –¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!', 'success');

            } catch (error) {
                log(`üí• –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∞: ${error.message}`, 'error');
                console.error('Test error:', error);
            }
        }

        function drawCabinet(panels, dimensions) {
            // –û—á–∏—â–∞–µ–º canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // –ú–∞—Å—à—Ç–∞–± –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
            const scale = Math.min(
                (canvas.width - 100) / dimensions.width,
                (canvas.height - 100) / dimensions.height
            );
            
            const offsetX = (canvas.width - dimensions.width * scale) / 2;
            const offsetY = (canvas.height - dimensions.height * scale) / 2;

            // –¶–≤–µ—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø–∞–Ω–µ–ª–µ–π
            const colors = {
                'FRONT_BASE': '#ff6b6b',    // –ö—Ä–∞—Å–Ω—ã–π –¥–ª—è –ø–µ—Ä–µ–¥–Ω–µ–≥–æ —Ü–æ–∫–æ–ª—è
                'BACK_BASE': '#4ecdc4',     // –ë–∏—Ä—é–∑–æ–≤—ã–π –¥–ª—è –∑–∞–¥–Ω–µ–≥–æ —Ü–æ–∫–æ–ª—è
                'LEFT_SIDE': '#45b7d1',     // –°–∏–Ω–∏–π –¥–ª—è –±–æ–∫–æ–≤–∏–Ω
                'RIGHT_SIDE': '#45b7d1',
                'TOP': '#96ceb4',           // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –≤–µ—Ä—Ö–∞/–Ω–∏–∑–∞
                'BOTTOM': '#96ceb4',
                'BACK_WALL': '#ffeaa7',     // –ñ–µ–ª—Ç—ã–π –¥–ª—è –∑–∞–¥–Ω–µ–π —Å—Ç–µ–Ω–∫–∏
                'FACADE': '#dda0dd'         // –§–∏–æ–ª–µ—Ç–æ–≤—ã–π –¥–ª—è —Ñ–∞—Å–∞–¥–∞
            };

            // –†–∏—Å—É–µ–º –ø–∞–Ω–µ–ª–∏
            panels.forEach(panel => {
                const pos = panel.position;
                const size = panel.dimensions;
                
                // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–∞ canvas (2D –≤–∏–¥ —Å–≤–µ—Ä—Ö—É, –∏—Å–ø–æ–ª—å–∑—É–µ–º X –∏ Y)
                const x = offsetX + pos.x * scale;
                const y = offsetY + pos.y * scale;
                const w = size.width * scale;
                const h = size.height * scale;

                // –ó–∞–ª–∏–≤–∫–∞
                ctx.fillStyle = colors[panel.key] || '#e0e0e0';
                ctx.fillRect(x, y, w, h);

                // –û–±–≤–æ–¥–∫–∞
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 1;
                ctx.strokeRect(x, y, w, h);

                // –ü–æ–¥–ø–∏—Å—å
                ctx.fillStyle = '#333';
                ctx.font = '10px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                
                const text = panel.key === 'FRONT_BASE' ? '–¶–û–ö–û–õ–¨ –ü' : panel.name;
                ctx.fillText(text, x + w/2, y + h/2);
            });

            // –†–∏—Å—É–µ–º —Ä–∞–∑–º–µ—Ä—ã —à–∫–∞—Ñ–∞
            ctx.strokeStyle = '#666';
            ctx.font = '12px Arial';
            ctx.fillStyle = '#666';
            
            // –®–∏—Ä–∏–Ω–∞
            const topY = offsetY - 20;
            ctx.fillText(`${dimensions.width}–º–º`, offsetX + (dimensions.width * scale) / 2, topY);
            
            // –í—ã—Å–æ—Ç–∞
            const leftX = offsetX - 30;
            ctx.save();
            ctx.translate(leftX, offsetY + (dimensions.height * scale) / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText(`${dimensions.height}–º–º`, 0, 0);
            ctx.restore();
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç
        runTest();

    </script>
</body>
</html>