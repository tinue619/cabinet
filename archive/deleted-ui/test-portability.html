<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Cabinet Portability</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #f0f0f0;
        }
        .test {
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 5px;
        }
        .pass { border-left: 4px solid green; }
        .fail { border-left: 4px solid red; }
        .pending { border-left: 4px solid orange; }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç –ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞</h1>
    
    <div id="tests"></div>
    
    <script type="module">
        const tests = document.getElementById('tests');
        
        function addTest(name, status, message) {
            const div = document.createElement('div');
            div.className = `test ${status}`;
            div.innerHTML = `
                <strong>${status === 'pass' ? '‚úÖ' : status === 'fail' ? '‚ùå' : '‚è≥'} ${name}</strong>
                <div>${message}</div>
            `;
            tests.appendChild(div);
        }
        
        // –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —è–¥—Ä–∞
        addTest('–ü—Ä–æ–≤–µ—Ä–∫–∞ —è–¥—Ä–∞', 'pending', '–ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å new_core...');
        
        try {
            const { SystemFactory } = await import('./new_core/index.js');
            addTest('–Ø–¥—Ä–æ new_core', 'pass', '–Ø–¥—Ä–æ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ');
            
            // –¢–µ—Å—Ç 2: –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
            try {
                const system = SystemFactory.create();
                addTest('–°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã', 'pass', '–°–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞–Ω–∞');
                
                // –¢–µ—Å—Ç 3: –°–æ–∑–¥–∞–Ω–∏–µ —à–∫–∞—Ñ–∞
                try {
                    const cabinet = system.createCabinet({
                        width: 800,
                        height: 2000,
                        depth: 600,
                        baseHeight: 100
                    });
                    cabinet.generate();
                    const stats = cabinet.getStats();
                    addTest('–°–æ–∑–¥–∞–Ω–∏–µ —à–∫–∞—Ñ–∞', 'pass', `–®–∫–∞—Ñ —Å–æ–∑–¥–∞–Ω: ${stats.panelsCount} –ø–∞–Ω–µ–ª–µ–π`);
                } catch (e) {
                    addTest('–°–æ–∑–¥–∞–Ω–∏–µ —à–∫–∞—Ñ–∞', 'fail', e.message);
                }
                
            } catch (e) {
                addTest('–°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã', 'fail', e.message);
            }
            
        } catch (e) {
            addTest('–Ø–¥—Ä–æ new_core', 'fail', '–ù–µ –Ω–∞–π–¥–µ–Ω–æ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å: ./new_core/index.js');
        }
        
        // –¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        addTest('–ü—Ä–æ–≤–µ—Ä–∫–∞ cabinet-app', 'pending', '–ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
        
        try {
            const response = await fetch('./cabinet-app/index.html');
            if (response.ok) {
                addTest('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ cabinet-app', 'pass', 'index.html –Ω–∞–π–¥–µ–Ω');
            } else {
                addTest('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ cabinet-app', 'fail', 'index.html –Ω–µ –Ω–∞–π–¥–µ–Ω');
            }
        } catch (e) {
            addTest('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ cabinet-app', 'fail', '–ü–∞–ø–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
        }
        
        // –¢–µ—Å—Ç 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
        try {
            const { CORE_PATH } = await import('./cabinet-app/src/config.js');
            addTest('–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è', 'pass', `–ü—É—Ç—å –∫ —è–¥—Ä—É: ${CORE_PATH}`);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ª–∏ –ø—É—Ç—å
            if (CORE_PATH === '../../new_core/index.js') {
                addTest('–ü—É—Ç—å –∫ —è–¥—Ä—É', 'pass', '–ü—É—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã');
            } else {
                addTest('–ü—É—Ç—å –∫ —è–¥—Ä—É', 'pending', '–ü—É—Ç—å –∏–∑–º–µ–Ω–µ–Ω - —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π');
            }
        } catch (e) {
            addTest('–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è', 'fail', '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å config.js');
        }
        
        // –ò—Ç–æ–≥–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
        setTimeout(() => {
            const allTests = document.querySelectorAll('.test');
            const passed = document.querySelectorAll('.test.pass').length;
            const failed = document.querySelectorAll('.test.fail').length;
            
            const summary = document.createElement('div');
            summary.className = 'test ' + (failed === 0 ? 'pass' : 'fail');
            summary.innerHTML = `
                <h2>${failed === 0 ? '‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã!' : '‚ùå –ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã'}</h2>
                <div>–ü—Ä–æ–π–¥–µ–Ω–æ: ${passed}, –ü—Ä–æ–≤–∞–ª–µ–Ω–æ: ${failed}</div>
                ${failed === 0 ? 
                    '<div><strong>–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –ø–µ—Ä–µ–Ω–æ—Å—É!</strong></div>' : 
                    '<div><strong>–ò—Å–ø—Ä–∞–≤—å—Ç–µ –æ—à–∏–±–∫–∏ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–Ω–æ—Å–æ–º</strong></div>'
                }
            `;
            tests.appendChild(summary);
        }, 1000);
    </script>
</body>
</html>